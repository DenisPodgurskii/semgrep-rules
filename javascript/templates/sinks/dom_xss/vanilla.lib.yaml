#@ def vanilla_sinks():
- patterns:
      - pattern-either:
            - pattern: $X.setAttribute("$LS", $SRC)
            - pattern: $X.setAttribute(...,"$LS", $SRC)
            - pattern: location = $SRC
            - pattern: $X.location = $SRC
            - pattern: location.$LS = $SRC
            - pattern: $X.location.$LS = $SRC
      - focus-metavariable: $SRC
      - metavariable-regex:
            metavariable: $LS
            regex: ^(href|hash|origin|search|pathname)$
      - metavariable-pattern:
            metavariable: $SRC
            patterns:
                - pattern-not: |
                      "..."
                - pattern-not: |
                      "..." + $VALUE
                - pattern-not: |
                      `...${$VALUE}`
                - pattern-not: |
                      "..." + $VALUE + "..."
                - pattern-not: |
                      `...${$VALUE}...`
- patterns:
      - pattern-either:
            - pattern: window.open(...,$SRC,...)
            - pattern: $X.window.open(...,$SRC,...)
            - pattern: $SINK.innerHTML = $SRC
            - pattern: $SINK.innerHTML(...,$SRC,...)
            - pattern: $SINK.outerHTML = $SRC
            - pattern: $SINK.outerHTML(...,$SRC,...)
            - pattern: $SINK.insertAdjacentHTML = $SRC
            - pattern: $SINK.insertAdjacentHTML(...,$SRC,...)
            - pattern: document.write(...,$SRC,...)
            - pattern: $SINK.document.write(...,$SRC,...)
            - pattern: document.writeln(...,$SRC,...)
            - pattern: $SINK.document.writeln(...,$SRC,...)
      - focus-metavariable: $SRC
#@ end
